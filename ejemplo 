<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Formulario de Suscripción</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; }
        label { display: block; margin-top: 15px; font-weight: bold; }
        input[type="text"], input[type="email"] {
            width: 300px; padding: 8px; margin-top: 5px;
        }
        small { color: gray; display: block; margin-bottom: 10px; }
        button { margin-top: 20px; padding: 10px 20px; font-size: 16px; cursor: pointer; }
    </style>
</head>
<body>

<h2>Formulario de Suscripción</h2>
<form method="post" action="">
    <label for="nombre">Nombre:</label>
    <input type="text" id="nombre" name="nombre" placeholder="Ingrese su nombre" required>
    <small>
        - Coincida con tres vocales seguidas.<br>
        - Coincida con tres vocales.<br>
        - Coincida con dos palabras.<br>
        - Coincida con una frase de entre 20 y 30 caracteres.<br>
        - Coincida con dos «a» seguidas y dos «e» seguidas en cualquier orden.
    </small>

    <label for="apellido">Apellido:</label>
    <input type="text" id="apellido" name="apellido" placeholder="Ingrese su apellido" required>
    <small>
        - Coincida con tres vocales seguidas.<br>
        - Coincida con tres vocales.<br>
        - Coincida con dos palabras.<br>
        - Coincida con una frase de entre 20 y 30 caracteres.<br>
        - Coincida con dos «a» seguidas y dos «e» seguidas en cualquier orden.
    </small>

    <label for="email">Correo Electrónico:</label>
    <input type="email" id="email" name="email" placeholder="ejemplo@dominio.com" required>
    <small>- Coincida con el formato de una dirección válida de correo electrónico</small>

    <button type="submit" name="submit">Suscribirse</button>
</form>

<?php
if (isset($_POST['submit'])) {
    $nombre   = trim($_POST['nombre']);
    $apellido = trim($_POST['apellido']);
    $email    = trim($_POST['email']);

    // Expresiones regulares y validaciones
    $tresVocalesSeguidas = "/[aeiou]{3}/i";
    $tresVocales = "/(?:.*[aeiou]){3,}/i";
    $dosPalabras = "/^\w+\s+\w+$/";
    $frase20a30 = "/^.{20,30}$/";
    $dobleAydobleE = "/aa.*ee|ee.*aa/i";
    $emailRegex = "/^[^\s@]+@[^\s@]+\.[^\s@]+$/";

    function validarNombreApellido($texto, $expresiones) {
        foreach ($expresiones as $regex) {
            if (preg_match($regex, $texto)) {
                return true;
            }
        }
        return false;
    }

    $expresiones = [$tresVocalesSeguidas, $tresVocales, $dosPalabras, $frase20a30, $dobleAydobleE];

    if (validarNombreApellido($nombre, $expresiones) &&
        validarNombreApellido($apellido, $expresiones) &&
        preg_match($emailRegex, $email)) {
        
        echo "<script>alert('Se ha registrado satisfactoriamente.');</script>";
    } else {
        echo "<script>alert('Compruebe que los textos ingresados cumplen con las indicaciones sugeridas.');</script>";
    }
}
?>
</body>
</html>